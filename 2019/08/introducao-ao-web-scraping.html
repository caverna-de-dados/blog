<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Introdução ao Web Scraping</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
  <!-- <link href="https://cavernadedados.com/" rel="canonical" /> -->
  <meta property="fb:app_id" content="87741124305" />

  <!-- Feed -->

  <link href="https://cavernadedados.com/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://cavernadedados.com/theme/css/code_blocks/monokai.css" rel="stylesheet">

    <!-- CSS specified by the user -->


    <link href="https://cavernadedados.com/assets/css/custom.css" type="text/css" rel="stylesheet" />

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->


  <link href="https://cavernadedados.com/2019/08/introducao-ao-web-scraping.html" rel="canonical" />

    <meta name="description" content="Introdução aos conceitos básicos de Web Scraping utilizando a linguagem Python e os pacotes Pandas e Matplotlib.">

    <meta name="author" content="leonam">

    <meta name="tags" content="Web Scraping">
    <meta name="tags" content="Python">




<!-- Open Graph -->
<meta property="og:site_name" content="Caverna de Dados (Este blog ainda está em contrução)"/>
<meta property="og:title" content="Introdução ao Web Scraping"/>
<meta property="og:description" content="Introdução aos conceitos básicos de Web Scraping utilizando a linguagem Python e os pacotes Pandas e Matplotlib."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://cavernadedados.com/2019/08/introducao-ao-web-scraping.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-08-02 12:31:00+02:00"/>
<meta property="article:modified_time" content="2019-08-02 12:31:00+02:00"/>
<meta property="article:author" content="https://cavernadedados.com/author/leonam">
  <meta property="article:publisher" content="https://www.facebook.com/myprofile/" />
<meta property="article:section" content="Tutoriais"/>
<meta property="article:tag" content="Web Scraping"/>
<meta property="article:tag" content="Python"/>
<meta property="og:image" itemprop="image" content="https://cavernadedados.com/assets/img/post-3/giphy.gif">
<meta property="og:image:secure_url" itemprop="image" content="https://cavernadedados.com/assets/img/post-3/giphy.gif">
<meta property="og:image:width" content="400" /> 
<meta property="og:image:height" content="300" />

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Introdução ao Web Scraping",
  "headline": "Introdução ao Web Scraping",
  "datePublished": "2019-08-02 12:31:00+02:00",
  "dateModified": "2019-08-02 12:31:00+02:00",
  "author": {
    "@type": "Person",
    "name": "leonam",
    "url": "https://cavernadedados.com/author/leonam"
  },
  "image": "https://cavernadedados.com/assets/img/post-3/giphy.gif",
  "url": "https://cavernadedados.com/2019/08/introducao-ao-web-scraping.html",
  "description": "Introdução aos conceitos básicos de Web Scraping utilizando a linguagem Python e os pacotes Pandas e Matplotlib."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>

              <li role="presentation"><a href="https://cavernadedados.com/pages/sobre/">Sobre o Caverna de Dados</a></li>

    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="blog-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span class="blog-logo">
                <a href="https://cavernadedados.com/"><img src="/assets/img/logo.png" alt="Blog Logo" /></a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Introdução ao Web Scraping</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://cavernadedados.com/author/leonam">Leonam Mendonça</a>
            | <time datetime="Fri 02 August 2019">Fri 02 August 2019</time>
        </span>
        <!-- TODO : Modified check -->
            <span class="post-meta"> | Updated on Fri 02 August 2019</span>
            <div class="post-cover cover" style="background-image: url('https://cavernadedados.com/assets/img/post-3/giphy.gif')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>Este breve artigo será desenvolvido em duas seções principais. Você irá entender o que é Web Scraping, e posteriormente iremos importar para o pandas os dados obtidos com esta técnica.</p>
<p>Vamos lá!</p>
<h1>O que é Web Scraping?</h1>
<p>Também conhecido como Extração de Dados da Web, é a ação de extrair automaticamente dados específicos de uma página web e armazená-los de forma estruturada, por exemplo em um arquivo de texto, planilha, JSON, XML, etc. Essa coleta pode ser usada para replicar informações em outro site ou para a análise de dados. É basicamente um “garimpo” na internet para extrair informações relevantes de uma página web. Normalmente, de forma mais rápida e eficiente que uma pessoa conseguiria fazer sem o scraping.</p>
<p>Não tem coisa melhor né?! Contudo, geralmente, as empresas preferem não desenvolver um Web Scraping por conta da manutenção constante que deve ser feita no algoritmo. Toda vez que um site mudar seu estilo, existe a possibilidade do scraping falhar. Por isso, procuram primeiramente saber se é possível obter as informações desejadas através de uma API.</p>
<p>Agora que você já sabe o que é o Scraping, temos que considerar alguns pontos importantes na hora de adotar esta abordagem de coleta de dados.</p>
<p>Aqui estão alguns conselhos:</p>
<ul>
<li>Dê preferência a utilização de uma API, se uma for fornecida (vai facilitar a sua vida);</li>
<li>Respeite os Termos de Serviço;</li>
<li>Respeite as regras do robots.txt; e</li>
<li>Não faça um bombardeio de requisições no site. Isso pode causar lentidão no servidor e você pode ser banido do website. Use uma taxa de rastreamento razoável (1 requisição a cada 10 segundos, por exemplo).</li>
</ul>
<p>Vamos colocar isto em prática!</p>
<h1>Preparação dos Pacotes</h1>
<p>Antes de começar qualquer coisa, precisamos importar os pacotes que utilizaremos, que serão:  </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>


<ul>
<li><strong>Datetime.</strong> Fornece classes para manipular datas e horas.</li>
<li><strong>LXML.</strong> Biblioteca bastante extensa escrita para analizar documentos XML e HTML muito rapidamente.</li>
<li><strong>Requests.</strong> Para fazer solicitações HTTP em Python. Ele abstrai as complexidades de fazer solicitações por trás de uma API simples.</li>
<li><strong>Numpy.</strong> O Numpy é um pacote voltado para computação científica com Python, possui um objeto array N-dimensional que facilita a manipulação de matrizes, sendo fundamental para a Álgebra Linear.</li>
<li><strong>Pandas.</strong> Pandas é um poderoso pacote de análise de dados com linguagem Python, ele permite, por exemplo, que trabalhemos facilmente com Dataframes, consigamos informações estatísticas das nossas variáveis e até mesmo plotar gráficos.</li>
<li><strong>Matplotlib.</strong> O Matplotlib é uma das principais bibliotecas para plotar gráficos em Python, com ele é possível, por exemplo, plotar gráficos de linha, barra, setor, histogramas e até gráficos em 3D.</li>
</ul>
<h1>Fonte de Dados (nosso dataset)</h1>
<p>Nós iremos trabalhar com os dados do <strong>Prêmio Nobel</strong>. Vamos coletar isso de uma tabela da Wikipédia.</p>
<p><strong>URL da página da Web:</strong><br>
- <a href="http://en.wikipedia.org/wiki/List_of_Nobel_laureates">http://en.wikipedia.org/wiki/List_of_Nobel_laureates</a>  </p>
<p><strong>Termos de Uso:</strong><br>
- <a href="https://foundation.wikimedia.org/wiki/Terms_of_Use/pt-br">Termos de Uso da Wikimedia Foundation</a></p>
<p>Vamos buscar o conteúdo da página e construir uma árvore html.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_element</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&gt;</span><span class="si">%s</span><span class="s2"> ...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">attrib</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">text_content</span><span class="p">()[:</span><span class="mi">200</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://en.wikipedia.org/wiki/List_of_Nobel_laureates&#39;</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">print_element</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>


<h1>Encontrando a tabela</h1>
<p>Agora que já estruturamos o conteúdo do site, podemos localizar a tabela que iremos analisar. Primeiramente, vamos apresentar todas as tabelas que existem no site.</p>
<div class="highlight"><pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//table&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
    <span class="n">print_element</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nt">table</span> <span class="p">{</span><span class="err">&#39;class&#39;:</span> <span class="err">&#39;wikitable</span> <span class="err">sortable&#39;</span><span class="p">}</span><span class="o">&gt;</span>   <span class="nt">Year</span>  <span class="nt">Physics</span>  <span class="nt">Chemistry</span>  <span class="nt">Physiologyor</span> <span class="nt">Medicine</span>  <span class="nt">Literature</span>  <span class="nt">Peace</span>  <span class="nt">Economics</span>   <span class="nt">1901</span>  <span class="nt">Wilhelm</span> <span class="nt">R</span><span class="err">ö</span><span class="nt">ntgen</span>  <span class="nt">Jacobus</span> <span class="nt">Henricus</span> <span class="nt">van</span> <span class="s1">&#39;t Hoff  Emil Adolf von Behring  Sully Prudhomme  Henry Dunant;Frédéric P ...</span>
<span class="s1">&lt;table {&#39;</span><span class="nt">role</span><span class="s1">&#39;: &#39;</span><span class="nt">presentation</span><span class="s1">&#39;, &#39;</span><span class="nt">class</span><span class="s1">&#39;: &#39;</span><span class="nt">mbox-small</span> <span class="nt">plainlinks</span> <span class="nt">sistersitebox</span><span class="s1">&#39;, &#39;</span><span class="nt">style</span><span class="s1">&#39;: &#39;</span><span class="nt">background-color</span><span class="o">:</span><span class="p">#</span><span class="nn">f9f9f9</span><span class="o">;</span><span class="nt">border</span><span class="p">:</span><span class="nd">1px</span> <span class="nt">solid</span> <span class="p">#</span><span class="nn">aaa</span><span class="o">;</span><span class="nt">color</span><span class="o">:</span><span class="p">#</span><span class="nn">000</span><span class="s1">&#39;}&gt;   Wikimedia Commons has media related to Nobel laureates.  ...</span>
<span class="s1">&lt;table {&#39;</span><span class="nt">class</span><span class="s1">&#39;: &#39;</span><span class="nt">nowraplinks</span> <span class="nt">hlist</span> <span class="nt">collapsible</span> <span class="nt">collapsed</span> <span class="nt">navbox-inner</span><span class="s1">&#39;, &#39;</span><span class="nt">style</span><span class="s1">&#39;: &#39;</span><span class="nt">border-spacing</span><span class="p">:</span><span class="nd">0</span><span class="o">;</span><span class="nt">background</span><span class="p">:</span><span class="nd">transparent</span><span class="o">;</span><span class="nt">color</span><span class="p">:</span><span class="nd">inherit</span><span class="s1">&#39;}&gt;vteNobel Prizes Lists of Nobel laureates Prizes Chemistry Economics1 Literature Peace Physics Physiology or Medicine Laureatesby subject Chemistry Economics Literature Peace Physics Physiology or Medi ...</span>
<span class="s1">&lt;table {&#39;</span><span class="nt">class</span><span class="s1">&#39;: &#39;</span><span class="nt">nowraplinks</span> <span class="nt">navbox-subgroup</span><span class="s1">&#39;, &#39;</span><span class="nt">style</span><span class="s1">&#39;: &#39;</span><span class="nt">border-spacing</span><span class="p">:</span><span class="nd">0</span><span class="err">&#39;}</span><span class="o">&gt;</span><span class="nt">by</span> <span class="nt">subject</span> <span class="nt">Chemistry</span> <span class="nt">Economics</span> <span class="nt">Literature</span> <span class="nt">Peace</span> <span class="nt">Physics</span> <span class="nt">Physiology</span> <span class="nt">or</span> <span class="nt">Medicine</span> <span class="nt">by</span> <span class="nt">criterion</span> <span class="nt">African</span> <span class="nt">Arab</span> <span class="nt">Asian</span> <span class="nt">Black</span> <span class="nt">Female</span> <span class="nt">Latino</span> <span class="nt">and</span> <span class="nt">Hispanic</span> <span class="nt">by</span> <span class="nt">country</span> <span class="nt">Argentine</span> <span class="nt">Australian</span> <span class="nt">Belgian</span> <span class="nt">Chinese</span> <span class="nt">Danish</span> <span class="nt">H</span> <span class="o">...</span>
</pre></div>


<p>Temos que identificar de alguma forma o conteúdo que queremos. Neste caso, a tag da tabela que queremos está com os valores ‘wikitable’ e ‘sortable’ no atributo classe. Podemos usar isso para identificar e diferenciar essa tabela das demais.  </p>
<p><strong>Atenção.:</strong> algumas classes podem não aparecer, pois estão sendo incluídas dinamicamente pelo javascript e o pacote requests que estamos utilizando para fazer a requisição não está executando as funções javascript da página.</p>
<div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//table[@class=&quot;wikitable sortable&quot;]/tbody&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">print_element</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">tbody</span> <span class="err">{}</span><span class="o">&gt;</span> <span class="k">Year</span>  <span class="n">Physics</span>  <span class="n">Chemistry</span>  <span class="n">Physiologyor</span> <span class="n">Medicine</span>  <span class="n">Literature</span>  <span class="n">Peace</span>  <span class="n">Economics</span>   <span class="mi">1901</span>  <span class="n">Wilhelm</span> <span class="n">R</span><span class="err">ö</span><span class="n">ntgen</span>  <span class="n">Jacobus</span> <span class="n">Henricus</span> <span class="n">van</span> <span class="err">&#39;</span><span class="n">t</span> <span class="n">Hoff</span>  <span class="n">Emil</span> <span class="n">Adolf</span> <span class="n">von</span> <span class="n">Behring</span>  <span class="n">Sully</span> <span class="n">Prudhomme</span>  <span class="n">Henry</span> <span class="n">Dunant</span><span class="p">;</span><span class="n">Fr</span><span class="err">é</span><span class="n">d</span><span class="err">é</span><span class="n">ric</span> <span class="n">Pas</span> <span class="p">...</span>
</pre></div>


<h1>Extraindo assuntos e anos</h1>
<p>Vamos extrair todos os assuntos e os anos que são apresentados na tabela (<strong>1ª linha:</strong> assuntos e <strong>1ª coluna:</strong> anos).</p>
<div class="highlight"><pre><span></span><span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text_content</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]]</span>
<span class="n">subjects</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Physics&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chemistry&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Physiologyor Medicine&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Literature&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Peace&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Economics&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>


<h1>Extrair Dados dos Vencedores</h1>
<p>Para testar, vamos extrair apenas a primeira linha da tabela (assunto / vencedor).</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">subject</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">winner</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;span/span/span/a&#39;</span><span class="p">):</span>
        <span class="n">winner_name</span> <span class="o">=</span> <span class="n">winner</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
        <span class="n">winner_url</span> <span class="o">=</span> <span class="n">winner</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>
        <span class="k">print</span> <span class="p">(</span><span class="s2">&quot; - </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">winner_name</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Physics</span><span class="p">:</span> 
 <span class="o">-</span> <span class="n">Wilhelm</span> <span class="n">R</span><span class="err">ö</span><span class="n">ntgen</span>
<span class="n">Chemistry</span><span class="p">:</span> 
 <span class="o">-</span> <span class="n">Jacobus</span> <span class="n">Henricus</span> <span class="n">van</span> <span class="err">&#39;</span><span class="n">t</span> <span class="n">Hoff</span>
<span class="n">Physiologyor</span> <span class="n">Medicine</span><span class="p">:</span> 
 <span class="o">-</span> <span class="n">Emil</span> <span class="n">Adolf</span> <span class="n">von</span> <span class="n">Behring</span>
<span class="n">Literature</span><span class="p">:</span> 
 <span class="o">-</span> <span class="n">Sully</span> <span class="n">Prudhomme</span>
<span class="n">Peace</span><span class="p">:</span> 
 <span class="o">-</span> <span class="n">Henry</span> <span class="n">Dunant</span>
 <span class="o">-</span> <span class="n">Fr</span><span class="err">é</span><span class="n">d</span><span class="err">é</span><span class="n">ric</span> <span class="n">Passy</span>
<span class="n">Economics</span><span class="p">:</span>
</pre></div>


<p>Tudo certo! Agora podemos extrair todos os dados da tabela.</p>
<div class="highlight"><pre><span></span><span class="n">year_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">subject_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">name_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">url_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">y_index</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">years</span><span class="p">):</span>
    <span class="c1">#print year</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="n">y_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="c1">#print &quot;%s:&quot; % subject</span>
        <span class="k">for</span> <span class="n">winner</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;span/span/span/a&#39;</span><span class="p">):</span>
            <span class="n">winner_name</span> <span class="o">=</span> <span class="n">winner</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
            <span class="n">winner_url</span> <span class="o">=</span> <span class="n">winner</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>
            <span class="c1">#print &quot; - %s&quot; % winner_name</span>
            <span class="n">year_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
            <span class="n">subject_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winner_name</span><span class="p">)</span>
            <span class="n">url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winner_url</span><span class="p">)</span>
</pre></div>


<h1>Processando os dados no Pandas</h1>
<p>Vamos colocar nossos dados em um dataframe pandas e apresentar apenas os 5 primeiros registros.</p>
<div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;winner_name&quot;</span><span class="p">])</span>
<span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_list</span>
<span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year_list</span>
<span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url_list</span>
<span class="n">data_set</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>winner_name</th>
      <th>subject</th>
      <th>year</th>
      <th>url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wilhelm Röntgen</td>
      <td>Physics</td>
      <td>1901</td>
      <td>/wiki/Wilhelm_R%C3%B6ntgen</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jacobus Henricus van 't Hoff</td>
      <td>Chemistry</td>
      <td>1901</td>
      <td>/wiki/Jacobus_Henricus_van_%27t_Hoff</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Emil Adolf von Behring</td>
      <td>Physiologyor Medicine</td>
      <td>1901</td>
      <td>/wiki/Emil_Adolf_von_Behring</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sully Prudhomme</td>
      <td>Literature</td>
      <td>1901</td>
      <td>/wiki/Sully_Prudhomme</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Henry Dunant</td>
      <td>Peace</td>
      <td>1901</td>
      <td>/wiki/Henry_Dunant</td>
    </tr>
  </tbody>
</table>
</div>

<h2>Quantidade de prêmios por ano</h2>
<p>Podemos ver a quantidade de prêmios Nobel entregues por ano. </p>
<div class="highlight"><pre><span></span><span class="n">years_df</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">years_df</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Número de Prêmios&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Total de Prêmios: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_set</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="https://cavernadedados.com/assets/img/post-3/output_32_0.png"></p>
<div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">de</span> <span class="n">Pr</span><span class="err">ê</span><span class="n">mios</span><span class="p">:</span> <span class="mi">912</span>
</pre></div>


<h2>Quantidade de prêmios por assunto</h2>
<p>Agora podemos saber a soma acumulativa de Prêmios Nobel separando-os por assunto e por ano. </p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">[</span><span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">subject</span><span class="p">][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Soma acumulativa de Prêmios Nobel&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>


<p><img alt="png" src="https://cavernadedados.com/assets/img/post-3/output_34_0.png"></p>
<h2>Os efeitos da primeira e segunda guerra mundial</h2>
<p>Podemos observar como se deu as premiações nos períodos das guerras mundiais.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">[(</span><span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">subject</span><span class="p">)</span> <span class="o">&amp;</span>
                  <span class="p">(</span><span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1950</span><span class="p">)][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ano&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Soma acumulativa de Prêmios Nobel&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">1950</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">gca</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="n">gca</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">1914</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">))</span>
<span class="n">gca</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">1939</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">45</span><span class="o">-</span><span class="mi">39</span><span class="p">),</span> <span class="mi">60</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;WW I&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1915</span><span class="p">,</span><span class="mi">55</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;WW II&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1941</span><span class="p">,</span><span class="mi">55</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>


<p><img alt="png" src="https://cavernadedados.com/assets/img/post-3/output_37_0.png"></p>
<h1>Conclusão</h1>
<p>Entendemos o conceito de Web Scraping e as vantagens e desvantagens de desenvolvê-lo. Aplicamos nossos conhecimentos para gerar informações a partir dos dados da Wikipedia. Agora você já sabe qual técnica pode ser utilizada para automatizar a coleta de dados (garimpar) na internet.</p>
<p>Até a próxima garimpeiro! ;-)</p>
<h1>Referências</h1>
<ul>
<li><a href="https://docs.python-guide.org/scenarios/scrape/">https://docs.python-guide.org/scenarios/scrape</a></li>
<li><a href="https://nbviewer.jupyter.org/github/twistedhardware/mltutorial/blob/master/notebooks/data-mining/1.%20Web%20Scraping.ipynb">https://nbviewer.jupyter.org/github/twistedhardware</a></li>
<li><a href="https://lxml.de/">https://lxml.de</a></li>
<li><a href="https://realpython.com/python-requests/">https://realpython.com/python-requests</a></li>
</ul>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Introdução ao Web Scraping&amp;url=https://cavernadedados.com/2019/08/introducao-ao-web-scraping.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://cavernadedados.com/2019/08/introducao-ao-web-scraping.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=https://cavernadedados.com/2019/08/introducao-ao-web-scraping.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://cavernadedados.com/tag/web-scraping">Web Scraping</a><a href="https://cavernadedados.com/tag/python">Python</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src="https://cavernadedados.com/assets/img/leonam.jpg" alt="Leonam Mendonça" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="https://cavernadedados.com/author/leonam">Leonam Mendonça</a></h4>
                            <p class="post-author-about">É graduando em Análise e Desenvolvimento de Sistemas no Instituto Federal de Educação, Ciência e Tecnologia de São Paulo (IFSP), freelancer de desenvolvimento web e encantado por segurança da informação e perícia computacional.</p>
                            <span class="post-author-location"><i class="ic ic-location"></i> Campos do Jordão/SP</span>
                        <!-- Social linkes in alphabet order. -->
                            <span class="post-author-github"><a target="_blank" href="https://github.com/leonammp"><i class="ic ic-link"></i> GitHub</a></span>
                            <span class="post-author-linkedin"><a target="_blank" href="https://www.linkedin.com/in/leonammendonca"><i class="ic ic-link"></i> LinkedIn</a></span>
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script type="text/javascript" src="https://cavernadedados.com/theme/js/script.js"></script>

    <!-- Script specified by the user -->
    <script type="text/javascript"  src="https://cavernadedados.com/assets/js/custom.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-136764041-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-136764041-1', { 'anonymize_ip': true });
    </script>
</body>
</html>